我知道我得最后把代码汇总，但是我尽量先把保真度这一部分的写在一起吧。

这一个文件夹将会有以下代码：
1. 验证gamma矩阵是否满足NPA条件。【注:我不会写这个】
   此代码的逻辑完全照搬QETLAB的NPAHierarchy.m。且只会返回0和1.无法返回gamma矩阵

2. 构造tilted-chsh不等式验证部分的SWAP算符。【注：不合理】
   此代码的逻辑遵循[Physical characterization of quantum devices from nonlocal correlations]的第三章的A，以及第四章的D。
   具体写法请参考[1110.doc]。

3. 构造chsh不等式验证部分的SWAP算符。【注：不合理】
   此代码的逻辑遵循上篇文章的第四章的A。具体写法我还没写进去。当然文章里都写了。

4. 构造SDP求[你自己根据tilted-chsh的correlation构造的]tilted-chsh不等式的保真度。
   注意这里就是矩阵M的区别了，也就是从alpha,1,1,1,-1（还是alpha,1,-1,1,1，我忘了，你看看matlab）变成了8个数。
   因为测量设置没变，所以直接套用就行。注意这里加入了辅助算符B2，Bob方多了个，gamma矩阵也要变。
   具体约束写法请参考[1110.doc]。

5. 构造SDP求[你自己根据chsh的correlation构造的]chsh不等式的保真度。
   由于chsh的correlation构造的不等式我还没写，这一段就先放一放。具体约束写法我也没写。

6. fc2cg【将correlation矩阵转换成collin-gisin格式】

7. NPA源代码的所有辅助函数。npa_support.py
   包含以下函数： 
         ind = find_in_cell(val,A) 查找数组A中有没有数值val，返回val基于1的索引
         new_ind = update_ind(old_ind,k,m_vec,o_vec) 更新index，根据旧的index矩阵生成下一个index矩阵
         [res,res_type] = product_of_orthogonal(ind,m_vec) 简化投影测量的正交测量积，满足正交、幂等、恒等。
            返回简化后的index矩阵，以及-1,0,1,2的类型。分别为无法简化、0算符、单一算符、两方测量算符的乘积


子文件夹test_only
我只是希望你别啥代码都放一堆。

--------------npa_support.py   &  product_of_orthogonal.py
ind = find_in_cell(val,A)
注意在这里将“未找到”定义为了-1而不再是0.因为matlab的矩阵从1开始，而python从0开始。
为了防止之后和find_in_cell有关的数据要减1，就修改了一下。
BUT在update_ind()里面又有一个从0开始，虽然可能不会冲突但还是小心点。



new_ind = update_ind(old_ind,k,m_vec,o_vec)
（new）update_ind(old_ind: np.ndarray, k: int, m_vec: np.ndarray, o_vec: np.ndarray) -> np.ndarray:
功能：计算下一个指标矩阵（也就是ind_catalog内部的2xk的小矩阵），系统地生成所有可能的投影测量算符的乘积
    指标矩阵有2行，第一行是测量算符的索引. 0 1 2 3分别对应Alice方x=0, x=1. Bob方y=0, y=1.
    第二行是测量结果（在二分算符情况，一般都是0）
    注意在【MATLAB】中，这里的测量设置和结果索引均从0开始（比如测量设置是0123而不是1234）（也就是x,y和a,b的表述均从0到MA/OA-1）

[res,res_type] = product_of_orthogonal(ind,m_vec)
(new) product_of_orthogonal(ind: np.ndarray, m_vec: np.ndarray) -> Tuple[np.ndarray, int]
最核心的部分，使用了投影测量算符正交+幂等+交换的简化。
注意matlab部分有递归调用，这里改成了while-true


--------------------------NPA核心代码
NPAHierarchy.py: 经过测试可以正常返回1
NPAHierarchy_with_gamma.py: 可以返回矩阵，但是我没试，因为下面的测试代码(test_npa_gamma.py)已经可以得到gamma了。
    虽然gamma矩阵的部分元素(res_type == -1)的值和MATLAB的不一样。

NPAHierarchy_2.py: 将代码分为了【构建器builder】和【求解器solver】，之后在求fidelity的时候只调用builder。

NPAHierarchy_3.py: npa_constraints 增加一个参数 enforce_data=True

-----------------test测试代码
test_npa_gamma.py
在第85行打断点，点击右上角的甲虫用于debug。可以查看gamma矩阵和其他变量。


---------------------------新增辅助代码
locate_gamma.py: 因为要把可观测量的期望值<AxBy>转化为投影的形式，所以需要定位投影在gamma的哪个位置。

locate_gamma_2.py: 新增了CVX变量的适配，用于保真度代码里寻找位置。



----------------------------保真度代码
fidelity_chsh.py: 已加入保真度函数，不过chsh=2sqrt2的结果是2而不是1
fidelity_chsh2.py: 对比了一个local = 2.

robustness_chsh.py:
    1 没用到fc2cg
















